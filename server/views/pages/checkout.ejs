<!DOCTYPE html>
<html>
<head>
    <title>
        <%= title %>
    </title>
</head>
<body>
    <% include ../partials/header %>
    <style>
        @media (max-width: 768px) {
            .cartHeader {
                display: none;
            }
            .col-md-1 {
                text-align: center !important;
            }
        }
    </style>
    <div class="container pb-4">
        <div class="row">
            <div class="col-lg-7">
                <div class="mt-5">
                    <div class="card mt-5 mb-5">
                        <div class="row pt-3 pb-3 grey-text text-center">
                            <div class="col-md-7">
                                Product
                            </div>
                            <div class="col-md-2 cartHeader">
                                Quantity
                            </div>
                            <div class="col-md-3 cartHeader">
                                Price (S$)
                            </div>
                        </div>
                        <% for(var i=0; i<cartData.length; i++){ %>
                        <div class="row pt-3 pb-3 text-center" style="border-top:solid thin #e0e0e0" id="cartRow<%=cartData[i].dataValues.id%>">
                            <div class="col-md-7 text-left">
                                <div class="row pl-4">
                                    <div class="prodImgContainer ml-3 mr-2" style="width:100px">
                                        <div class="" style="
                                            background-image: url('<%=hostPath%>/images/products/<%=cartData[i].dataValues.productImage%>');
                                            background-size: contain;
                                            background-repeat: no-repeat;
                                            background-position: center center;
                                            width: 100%;
                                            padding-top: 100%;">
                                        </div>
                                    </div>
                                    <div class="col pt-3 pl-0 pr-0">
                                        <div>
                                            <%=cartData[i].dataValues.productName%>
                                        </div>
                                        <small class="grey-text">
                                            <%=cartData[i].dataValues.productType%>
                                        </small>
                                        <div>
                                            <small>Unit price: S$
                                                <span id="unitPrice<%=cartData[i].dataValues.id%>">
                                                    <%=cartData[i].dataValues.price%>
                                                </span>
                                            </small>
                                            <small class="grey-text"> (
                                                <span id="prodQuantity<%=cartData[i].dataValues.id%>">
                                                    <%=cartData[i].dataValues.prodQuantity%>
                                                </span> left)
                                            </small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mt-2 pt-4">
                                <h5><span style="font-size: 1.5rem; font-weight: 400"><%=cartData[i].dataValues.quantity%></span></h5>
                            </div>
                            <div class="col-md-3 text-weight-normal mt-2 pt-4 pr-0 pl-0" style="font-size:1.5rem">
                                <span id="cartPrice<%=cartData[i].dataValues.id%>"></span>
                                <script>
                                    document.getElementById("cartPrice<%=cartData[i].dataValues.id%>").innerText = parseFloat(parseInt("<%=cartData[i].dataValues.quantity%>") * parseFloat("<%=cartData[i].dataValues.price%>")).toFixed(2)
                                </script>
                            </div>
                        </div>
                        <% } %>
                    </div>
                </div>
            </div>
            <div class="col-lg-5">
                <div class="card mt-lg-5 mb-5 bg-dark text-white">
                    <h4 class="pl-4 pt-5 pb-4 mt-5" style="border-bottom:solid thin grey">My Silicon Wallet</h4>
                    <div class="row">
                        <div class="col pr-0">
                            <h5 class="pl-4 pt-2 pr-0">Balance</h5>
                        </div>
                        <div class="col-7">
                            <h5 class="font-weight-normal pt-2">S$ <%=cartData[0].dataValues.balance%></h5>
                        </div>
                    </div>
                    <h4 class="pl-4 pt-3 pb-4 mt-3" style="border-bottom:solid thin grey">My Address</h4>
                    <div class="row">
                        <div class="col pr-0">
                            <h5 class="pl-4 pt-2 pr-4"><%=cartData[0].dataValues.address%></h5>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pr-0">
                            <h5 class="pl-4 pt-2 pr-0">Postal</h5>
                        </div>
                        <div class="col-7">
                            <h5 class="font-weight-normal pt-2"><%=cartData[0].dataValues.postal_code%></h5>
                        </div>
                    </div>
                    <h4 class="pl-4 pt-3 pb-4 mt-3" style="border-bottom:solid thin grey">Check Out</h4>
                    <div class="row">
                        <div class="col">
                            <h5 class="pl-4 pt-4">Subtotal</h5>
                        </div>
                        <div class="col-7">
                            <h5 class="font-weight-normal pt-4">S$
                                <span id="cartSubTotal">0.00</span>
                            </h5>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h6 class="pl-4 pt-2 pr-0">Shipping</h6>
                        </div>
                        <div class="col-7">
                            <h6 class="font-weight-normal pt-2">Free</h6>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <h6 class="pl-4 pt-2 pr-0">Discount</h6>
                        </div>
                        <div class="col-7">
                            <h6 class="font-weight-normal pt-2">N/A</h6>
                        </div>
                    </div>
                    <div class="row pt-3 pb-3">
                        <div class="col">
                            <h3 class="pl-4 pt-3 text-weight-normal">Total</h3>
                        </div>
                        <div class="col-7">
                            <h3 class="font-weight-bold pt-3">$S
                                <span id="cartTotal">0.00</span>
                            </h3>
                        </div>
                    </div>
                    <div class="row p-3">
                        <div class="col p-4 mb-4">
                            <% if (cartData.length!=0) {%>
                                <button type="button" class="btn btn-warning btn-block font-weight-bold waves-effect waves-light" style="border-radius:10em!important;font-size: 1rem">Confirm Checkout</button>
                            <% } else { %>
                                <button disabled type="button" class="btn btn-warning btn-block font-weight-bold" style="border-radius:10em!important;font-size: 1rem">Confirm Checkout</button>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var total=0;
        var cartIDarr =[];
        `<% for(var i=0; i<cartData.length; i++){ %>`
        cartIDarr.push("<%=cartData[i].dataValues.id%>");
        `<% } %>`
        for (var i=0;i<cartIDarr.length;i++){
            $("#cartCheck"+cartIDarr[i]).prop('checked','checked');
            total+=parseFloat(document.getElementById("cartPrice"+cartIDarr[i]).innerText);
        };
        document.getElementById("cartSubTotal").innerText=parseFloat(total).toFixed(2);
        document.getElementById("cartTotal").innerText=parseFloat(total).toFixed(2);
    </script>
    <% include ../partials/footer %>
</body>
</html>